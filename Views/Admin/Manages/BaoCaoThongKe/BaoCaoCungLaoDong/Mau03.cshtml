@{
    Layout = "_LayoutPrint";
    var record_id = 1;
    // var DsHuyen = (IEnumerable<QLViecLam.Models.Admin.Systems.HeThongChung.DmHanhChinh>)ViewData["DsHuyen"]!;
    var DsXa = (IEnumerable<QLViecLam.Models.Admin.Systems.HeThongChung.DmHanhChinh>)ViewData["DsXa"]!;
    var DoiTuongUuTien = (IEnumerable<QLViecLam.Models.Admin.Systems.DanhMuc.DoiTuongUuTien>)ViewData["DoiTuongUuTien"]!;
    var NganhHoc = (IEnumerable<QLViecLam.Models.Admin.Systems.DanhMuc.NganhHoc>)ViewData["NganhHoc"]!;
    var TrinhDoCMKT = (IEnumerable<QLViecLam.Models.Admin.Systems.DanhMuc.TrinhDoCMKT>)ViewData["TrinhDoCMKT"]!;
    var DsDiaBan = (IEnumerable<QLViecLam.Models.Admin.Systems.HeThongChung.DmHanhChinh>)ViewData["DsDiaBan"]!;

    var KyTruoc = (IEnumerable<QLViecLam.Models.Admin.Manages.NhanKhau>)ViewData["KyTruoc"]!;
    var KyBaoCao = (IEnumerable<QLViecLam.Models.Admin.Manages.NhanKhau>)ViewData["KyBaoCao"]!;
}
@model IEnumerable<QLViecLam.Models.Admin.Manages.NhanKhau>

<table id="data_header" width="96%" cellspacing="0" cellpadding="8" style="margin:0 auto 20px; font-size: 12px">
    <tr>
        <td></td>
        <td class="text-right" style="font-style:italic">Mẫu số 03</td>
    </tr>
    <tr>
        <td width="50%" style="vertical-align: top; padding-left: 10% ;text-align: left">
            @if (ViewData["Tinh"] != null)
            {
                <p>@ViewData["Tinh"]</p>
            }
            @if (ViewData["Huyen"] != null)
            {
                <p>@ViewData["Huyen"]</p>
            }
            @if (ViewData["Xa"] != null)
            {
                <p>@ViewData["Xa"]</p>
            }
            <hr style="width: 10%;vertical-align: top;  margin-top: 2px">

        </td>
        <td style="vertical-align: top; text-align: center;padding-left: 10% ">
            <b>
                CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM<br>
                Độc lập - Tự do - Hạnh phúc
            </b>
            <hr style="color: black;width: 15%;vertical-align: top; margin-top: 2px">
        </td>
    </tr>
    <tr>
        <td width="50%" style=" text-align: left; padding-left: 10% ">
            <p>Số: ......../BC- </p>
        </td>
        <td style="text-align: center"><i style="margin-left: 15%;">Bình Định, ngày .... tháng .... năm ....</i></td>
    </tr>
    <tr>
        <td colspan="2" id="data_body1"
            style="text-align: center;font-weight: bold;font-size: 20px; text-transform: uppercase;">
            BÁO CÁO <br>VỀ THÔNG TIN CUNG LAO ĐỘNG @(ViewData["kydieutra"] != null ? "NĂM " + ViewData["kydieutra"] : "")
        </td>
    </tr>
    <tr style="font-style: italic;">
        <td rowspan="2" style="text-align: right;vertical-align: top;"> Kính gửi: </td>
        <td>Ủy ban nhân dân:.......................... <br> Sở Lao động - Thương binh và Xã hội </td>
    </tr>
</table>


<table id="data_body" cellspacing="0" cellpadding="0" border="1"
       style="margin: 20px auto; border-collapse: collapse;font-size: 12px" id="data">

    <tr style="text-align: center;">
        <th style="width: 5%;">STT</th>
        <th style="width: 45%;">Chỉ tiêu</th>
        <th style="width: 10%;">Đơn vị</th>
        <th style="width: 20%;">Kỳ trước</th>
        <th style="width: 20%;">Kỳ báo cáo</th>
    </tr>
    <tr style="text-align: center">
        <td> A </td>
        <td> B </td>
        <td> C </td>
        <td> D </td>
        <td> E </td>
    </tr>
    <tr>
        <th colspan="5" style=" text-transform: uppercase;text-align: left">
            I. THÔNG TIN CUNG LAO ĐỘNG
        </th>
    </tr>
    @*--- Số lương chung ------------*@
    <tr style="text-align: center;">
        <th>1</th>
        <th style=";text-align: left;">Số người từ 15 tuổi trở lên có nhu cầu tìm kiếm việc làm</th>
        <td>Người</td>
        <td>@KyTruoc.Count()</td>
        <td>@KyBaoCao.Count()</td>
    </tr>

    <tr>
        <td>a</td>
        <td colspan="4">Chia theo khu vực</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Thành thị</td>
        <td>Người</td>
        <td>@KyTruoc.Where(x => x.KhuVuc == "1").Count()</td>
        <td>@KyBaoCao.Where(x => x.KhuVuc == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nông thôn</td>
        <td>Người</td>
        <td>@KyTruoc.Where(x => x.KhuVuc == "2").Count()</td>
        <td>@KyBaoCao.Where(x => x.KhuVuc == "2").Count()</td>
    </tr>
    <tr>
        <td>b</td>
        <td colspan="4">Chia theo giới tính</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nam</td>
        <td>Người</td>
        <td>@KyTruoc.Where(x => x.Gioitinh == "1").Count()</td>
        <td>@KyBaoCao.Where(x => x.Gioitinh == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nữ</td>
        <td>Người</td>
        <td>@KyTruoc.Where(x => x.Gioitinh == "2").Count()</td>
        <td>@KyBaoCao.Where(x => x.Gioitinh == "2").Count()</td>
    </tr>
    <tr>
        <td>c</td>
        <td colspan="4">Chia theo trình độ chuyên môn kỹ thật</td>
    </tr>
    @foreach (var cmkt in TrinhDoCMKT)
    {
        <tr style="text-align: center;">
            <td>@cmkt.MaTrinhDoCMKT</td>
            <td style="text-align: left;">@cmkt.TenTrinhDoCMKT</td>
            <td>Người</td>
            <td>@KyTruoc.Where(x => x.TrinhDoCMKT == cmkt.MaTrinhDoCMKT).Count()</td>
            <td>@KyBaoCao.Where(x => x.TrinhDoCMKT == cmkt.MaTrinhDoCMKT).Count()</td>
        </tr>
    }
    <tr>
        <td>d</td>
        <td colspan="4">Nhu cầu tìm kiếm việc làm, học nghề </td>
    </tr>
    @{
        var KyTruoc_TrongNuoc = KyTruoc.Where(x => x.ViecLamMongMuon == "1" && x.ViecLamMongMuon == "3");
        var KyBaoCao_TrongNuoc = KyBaoCao.Where(x => x.ViecLamMongMuon == "1" && x.ViecLamMongMuon == "3");

        var KyTruoc_NuocNgoai = KyTruoc.Where(x => x.ViecLamMongMuon == "2" && x.ViecLamMongMuon == "3");
        var KyBaoCao_NuocNgoai = KyBaoCao.Where(x => x.ViecLamMongMuon == "2" && x.ViecLamMongMuon == "3");

        var KyTruoc_HocNghe = KyTruoc.Where(x => x.NganhNgheMuonHoc != null );
        var KyBaoCao_HocNghe = KyBaoCao.Where(x => x.NganhNgheMuonHoc != null );
    }
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Trong tỉnh, trong nước</td>
        <td>Người</td>
        <td>@KyTruoc_TrongNuoc.Count()</td>
        <td>@KyBaoCao_TrongNuoc.Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Đi làm việc ở nước ngoài</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Count()</td>
        <td>@KyBaoCao_NuocNgoai.Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Học nghề</td>
        <td>Người</td>
        <td>@KyTruoc_HocNghe.Count()</td>
        <td>@KyBaoCao_HocNghe.Count()</td>
    </tr>

    @* --- trong tỉnh tong nước -------------- *@
    <tr>
        <td style="font-weight: bold;">1.1</td>
        <td colspan="4" style="font-weight: bold;">Trong tỉnh, trong nước</td>
    </tr>
    <tr>
        <td>a</td>
        <td colspan="4">Chia theo khu vực</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Thành thị</td>
        <td>Người</td>
        <td>@KyTruoc_TrongNuoc.Where(x => x.KhuVuc == "1").Count()</td>
        <td>@KyBaoCao_TrongNuoc.Where(x => x.KhuVuc == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nông thôn</td>
        <td>Người</td>
        <td>@KyTruoc_TrongNuoc.Where(x => x.KhuVuc == "2").Count()</td>
        <td>@KyBaoCao_TrongNuoc.Where(x => x.KhuVuc == "2").Count()</td>
    </tr>
    <tr>
        <td>b</td>
        <td colspan="4">Chia theo giới tính</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nam</td>
        <td>Người</td>
        <td>@KyTruoc_TrongNuoc.Where(x => x.Gioitinh == "1").Count()</td>
        <td>@KyBaoCao_TrongNuoc.Where(x => x.Gioitinh == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nữ</td>
        <td>Người</td>
        <td>@KyTruoc_TrongNuoc.Where(x => x.Gioitinh == "2").Count()</td>
        <td>@KyBaoCao_TrongNuoc.Where(x => x.Gioitinh == "2").Count()</td>
    </tr>
    <tr>
        <td>c</td>
        <td colspan="4">Chia theo trình độ chuyên môn kỹ thật</td>
    </tr>
    @foreach (var cmkt in TrinhDoCMKT)
    {
        <tr style="text-align: center;">
            <td>@cmkt.MaTrinhDoCMKT</td>
            <td style="text-align: left;">@cmkt.TenTrinhDoCMKT</td>
            <td>Người</td>
            <td>@KyTruoc_TrongNuoc.Where(x => x.TrinhDoCMKT == cmkt.MaTrinhDoCMKT).Count()</td>
            <td>@KyBaoCao_TrongNuoc.Where(x => x.TrinhDoCMKT == cmkt.MaTrinhDoCMKT).Count()</td>
        </tr>
    }
    <tr>
        <td>d</td>
        <td colspan="4">Chia theo nghề nghiệp </td>
    </tr>
    @foreach (var nh in NganhHoc)
    {
        <tr style="text-align: center;">
            <td>@nh.MaNganhHoc</td>
            <td style="text-align: left;">@nh.TenNganhHoc</td>
            <td>Người</td>
            <td></td>
            <td></td>
          @*   <td>@KyTruoc_TrongNuoc.Where(x => x.NgheNghiep == nh.MaNganhHoc).Count()</td>
            <td>@KyBaoCao_TrongNuoc.Where(x => x.NgheNghiep == nh.MaNganhHoc).Count()</td> *@
        </tr>
    }

    @* ---làm việc nước ngoài---------- *@
    <tr>
        <td style="font-weight: bold;">1.2</td>
        <td colspan="4" style="font-weight: bold;">Đi làm việc ở nước ngoài</td>
    </tr>
    <tr>
        <td>a</td>
        <td colspan="4">Chia theo khu vực</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Thành thị</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.KhuVuc == "1").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.KhuVuc == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nông thôn</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.KhuVuc == "2").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.KhuVuc == "2").Count()</td>
    </tr>
    <tr>
        <td>b</td>
        <td colspan="4">Chia theo giới tính</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nam</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.Gioitinh == "1").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.Gioitinh == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nữ</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.Gioitinh == "2").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.Gioitinh == "2").Count()</td>
    </tr>
    <tr>
        <td>c</td>
        <td colspan="4">Chia theo thị trường</td>
    </tr>

    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Hàn Quốc</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.ThiTruongLamViec == "KR").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.ThiTruongLamViec == "KR").Count()</td>
    </tr>

    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nhật Bản</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.ThiTruongLamViec == "JP").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.ThiTruongLamViec == "JP").Count()</td>
    </tr>

    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Đài Loan</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.ThiTruongLamViec == "TW").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.ThiTruongLamViec == "TW").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Châu Âu</td>
        <td>Người</td>
        <td>@KyTruoc_NuocNgoai.Where(x => x.ThiTruongLamViec == "EU").Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => x.ThiTruongLamViec == "EU").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Khác</td>
        <td>Người</td>
        @{
            string[] MaQuocGia = new string[] { "VN", "KR", "JP", "TW", "EU" };
        }
        <td>@KyTruoc_NuocNgoai.Where(x => !MaQuocGia.Contains(x.ThiTruongLamViec)).Count()</td>
        <td>@KyBaoCao_NuocNgoai.Where(x => !MaQuocGia.Contains(x.ThiTruongLamViec)).Count()</td>
    </tr>
    <tr>
        <td style="font-weight: bold;">1.3</td>
        <td colspan="4" style="font-weight: bold;">Nhu cầu học nghề</td>
    </tr>
    <tr>
        <td>a</td>
        <td colspan="4">Chia theo khu vực</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Thành thị</td>
        <td>Người</td>
        <td>@KyTruoc_HocNghe.Where(x => x.KhuVuc == "1").Count()</td>
        <td>@KyBaoCao_HocNghe.Where(x => x.KhuVuc == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nông thôn</td>
        <td>Người</td>
        <td>@KyTruoc_HocNghe.Where(x => x.KhuVuc == "2").Count()</td>
        <td>@KyBaoCao_HocNghe.Where(x => x.KhuVuc == "2").Count()</td>
    </tr>
    <tr>
        <td>b</td>
        <td colspan="4">Chia theo giới tính</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nam</td>
        <td>Người</td>
        <td>@KyTruoc_HocNghe.Where(x => x.Gioitinh == "1").Count()</td>
        <td>@KyBaoCao_HocNghe.Where(x => x.Gioitinh == "1").Count()</td>
    </tr>
    <tr style="text-align: center;">
        <td></td>
        <td style="text-align: left;">- Nữ</td>
        <td>Người</td>
        <td>@KyTruoc_HocNghe.Where(x => x.Gioitinh == "2").Count()</td>
        <td>@KyBaoCao_HocNghe.Where(x => x.Gioitinh == "2").Count()</td>
    </tr>
    <tr>
        <td>c</td>
        <td colspan="4">Chia theo ngành nghề</td>
    </tr>
    @foreach (var nh in NganhHoc)
    {
        <tr style="text-align: center;">
            <td>@nh.MaNganhHoc</td>
            <td style="text-align: left;">@nh.TenNganhHoc</td>
            <td>Người</td>
            <td></td>
            <td></td>
            @*   <td>@KyTruoc_HocNghe.Where(x => x.NgheNghiep == nh.MaNganhHoc).Count()</td>
        <td>@KyBaoCao_HocNghe.Where(x => x.NgheNghiep == nh.MaNganhHoc).Count()</td> *@
        </tr>
    }
</table>
<table id="data_footer" width="96%" cellspacing="0" cellpadding="0"
       style="margin: 20px auto;text-align: center; height:200px;font-size: 12px">
    <tr>
        <td width="60%" style="text-align: left; vertical-align: top;">
        </td>
        <td style="vertical-align: top;">
            <b>ỦY BAN NHÂN DÂN.......................</b><br>
        </td>
    </tr>
</table>
